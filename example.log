Creating training model...
Compiling Theano graph...
Training...
C:\Anaconda2\lib\site-packages\keras\backend\theano_backend.py:489: UserWarning: theano.function was asked to create a function computing outputs given certain inputs, but the provided input variable at index 0 is not part of the computational graph needed to compute the outputs: gbrbm_input_1.
To make this warning into an error, you can pass the parameter on_unused_input='raise' to theano.function. To disable it completely, use on_unused_input='ignore'.
  **kwargs)
Epoch 1/30
3876/3876 [==============================] - 4s - loss: 0.5470 - reconstruction_loss: 0.3420     
Epoch 2/30
3876/3876 [==============================] - 4s - loss: 0.5468 - reconstruction_loss: 0.3372     
Epoch 3/30
3876/3876 [==============================] - 5s - loss: 0.5468 - reconstruction_loss: 0.3343     
Epoch 4/30
3876/3876 [==============================] - 5s - loss: 0.5467 - reconstruction_loss: 0.3328     
Epoch 5/30
3876/3876 [==============================] - 4s - loss: 0.5467 - reconstruction_loss: 0.3315     
Epoch 6/30
3876/3876 [==============================] - 5s - loss: 0.5466 - reconstruction_loss: 0.3315     
Epoch 7/30
3876/3876 [==============================] - 4s - loss: 0.5465 - reconstruction_loss: 0.3306     
Epoch 8/30
3876/3876 [==============================] - 4s - loss: 0.5465 - reconstruction_loss: 0.3303     
Epoch 9/30
3876/3876 [==============================] - 4s - loss: 0.5464 - reconstruction_loss: 0.3306     
Epoch 10/30
3876/3876 [==============================] - 4s - loss: 0.5462 - reconstruction_loss: 0.3318     
Epoch 11/30
3876/3876 [==============================] - 4s - loss: 0.5461 - reconstruction_loss: 0.3304     
Epoch 12/30
3876/3876 [==============================] - 4s - loss: 0.5459 - reconstruction_loss: 0.3310     
Epoch 13/30
3876/3876 [==============================] - 4s - loss: 0.5456 - reconstruction_loss: 0.3319     
Epoch 14/30
3876/3876 [==============================] - 4s - loss: 0.5454 - reconstruction_loss: 0.3335     
Epoch 15/30
3876/3876 [==============================] - 5s - loss: 0.5451 - reconstruction_loss: 0.3339     
Epoch 16/30
3876/3876 [==============================] - 5s - loss: 0.5447 - reconstruction_loss: 0.3329     
Epoch 17/30
3876/3876 [==============================] - 4s - loss: 0.5442 - reconstruction_loss: 0.3331     
Epoch 18/30
3876/3876 [==============================] - 4s - loss: 0.5437 - reconstruction_loss: 0.3337     
Epoch 19/30
3876/3876 [==============================] - 5s - loss: 0.5431 - reconstruction_loss: 0.3361     
Epoch 20/30
3876/3876 [==============================] - 4s - loss: 0.5424 - reconstruction_loss: 0.3358     
Epoch 21/30
3876/3876 [==============================] - 4s - loss: 0.5415 - reconstruction_loss: 0.3384     
Epoch 22/30
3876/3876 [==============================] - 4s - loss: 0.5405 - reconstruction_loss: 0.3377     
Epoch 23/30
3876/3876 [==============================] - 4s - loss: 0.5392 - reconstruction_loss: 0.3370     
Epoch 24/30
3876/3876 [==============================] - 5s - loss: 0.5378 - reconstruction_loss: 0.3386     
Epoch 25/30
3876/3876 [==============================] - 5s - loss: 0.5361 - reconstruction_loss: 0.3436     
Epoch 26/30
3876/3876 [==============================] - 5s - loss: 0.5342 - reconstruction_loss: 0.3458     
Epoch 27/30
3876/3876 [==============================] - 5s - loss: 0.5319 - reconstruction_loss: 0.3449     
Epoch 28/30
3876/3876 [==============================] - 5s - loss: 0.5291 - reconstruction_loss: 0.3492     
Epoch 29/30
3876/3876 [==============================] - 5s - loss: 0.5261 - reconstruction_loss: 0.3472     
Epoch 30/30
3876/3876 [==============================] - 5s - loss: 0.5226 - reconstruction_loss: 0.3495     
Creating inference model...
Compiling Theano graph...
Doing inference...
[[ 0.50979269]
 [ 0.51814681]
 [ 0.52649075]
 ..., 
 [ 0.53108323]
 [ 0.53810751]
 [ 0.53860027]]
[ 23.  23.  23. ...,  23.  23.  23.]
RBM Prediction Accuracy = 69.47 %
Done!
MSE
5.85039723604
MAE
4.31622610118
